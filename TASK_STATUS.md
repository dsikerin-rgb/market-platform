# Статус выполнения задач

Обновлённый список по запросу "Market Platform — настройки рынка, модули, отчёты, приглашения, 1С, задачи, обращения". Статусы указаны на основе текущего кода репозитория.

## 1. Настройки рынка (единый экран)
* **Статус:** не реализовано. Нет страницы/ресурса для редактирования настроек рынка и хранения `settings`/`features` в форме.

## 2. Справочники и тарифы
* **2.1 Типы локаций:** реализовано. Есть миграции, модель и Filament-ресурс `MarketLocationTypeResource` с фильтрацией по рынку.
* **2.2 Типы торговых мест + тарифы:** реализовано. Есть миграции, модель и Filament-ресурс `MarketSpaceTypeResource`; формы локаций/мест используют справочники типов рынка.

## 3. Роли и права (UI только для super-admin)
* **Статус:** реализовано. Добавлены PermissionResource и доработан RoleResource: переводное поле `label_ru`, выбор прав через мультиселект, вывод прав в таблице.

## 4. Модульная система (feature flags)
* **Частично.** Добавлено поле `features` в markets и помощник `MarketFeature::enabled`, но скрытие/ограничение навигации/ресурсов по флагам не внедрено.

## 5. Раздел "Отчёты"
* **Прогресс:** добавлены миграции `reports` и `report_runs` и модели `Report`/`ReportRun`.
* **Осталось:** jobs, команда расписания, Filament UI (ресурсы + запуск/история), формирование файлов и отправка на email.

## 6. Приглашение сотрудников по email
* **Прогресс:** добавлена таблица `staff_invitations` и модель `StaffInvitation`.
* **Осталось:** InviteStaffAction в StaffResource, письмо/маршрут приёма, создание пользователя по токену.

## 7. 1С импорт/экспорт
* **Прогресс:** добавлена таблица `integration_exchanges` и модель `IntegrationExchange` для хранения истории обменов.
* **Осталось:** ресурс IntegrationExchangeResource, jobs `ExportTo1CJob`/`ImportFrom1CJob`, загрузка/выгрузка файлов и запуск из UI.

## 8. "Задачи" (CRM-подобно) + автозаявки
* **Прогресс:** созданы таблицы `tasks`, `task_watchers`, `task_comments` и модели `Task`/`TaskWatcher`/`TaskComment`.
* **Осталось:** Filament-ресурс TaskResource, политики по market_id, связь с обращениями и автосоздание задач.

## 9. "Обращения от арендаторов" отдельным разделом
* **Статус:** не реализовано. TenantRequest не вынесен в отдельный ресурс, нет действия создания задачи.

## 10. Итоговый комплект (миграции, политики, jobs, mail, флаги)
* **Статус:** частично (готовы справочники, миграции и модели по пунктам 5–8, helper feature flag). Остальные части не покрыты.

## Обнаруженные потенциальные ошибки
* **Отсутствуют установленные зависимости в vendor/** — невозможно подтвердить наличие нужных классов Filament, что повышает риск падений при загрузке ресурсов; требуется выполнить `composer install` при доступе к пакету. 
* **RelationManager-ы используют незащищённые table-actions** (`Tables\Actions\EditAction` / `DeleteAction`) без проверки class_exists, поэтому при несовпадении с установленной версией Filament возможна ошибка загрузки страниц обращений и договоров.
